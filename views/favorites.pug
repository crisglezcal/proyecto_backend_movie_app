extends dashboard

block content
  
  .favorites-container
    
    //- VERIFICAR SI EL USUARIO EST√Å LOGUEADO: "user" viene del middleware de autenticaci√≥n
    if user
      
      //- T√çTULO DE LA P√ÅGINA (solo para usuarios logueados)
      h1.favorites-title Mis pel√≠culas favoritas ‚ù§Ô∏è
      
      //- MENSAJE DE BIENVENIDA PERSONALIZADO: Muestra el nombre del usuario usando interpolaci√≥n #{}
      p.welcome-message ¬°Hola! Estas son tus pel√≠culas favoritas
      
      //- VERIFICAR SI HAY PEL√çCULAS FAVORITAS: Comprueba que "favorites" existe y tiene al menos 1 elemento
      if favorites && favorites.length > 0
        
        //- ESTAD√çSTICAS - Mostrar cantidad de favoritos
        .favorites-stats
          p Tienes #[strong #{favorites.length}] pel√≠cula(s) en favoritos
        
        //- CONTENEDOR GRID PARA LAS PEL√çCULAS: Dise√±o en cuadr√≠cula para mostrar las pel√≠culas
        .films-grid
          
          //- BUCLE POR CADA PEL√çCULA EN FAVORITOS: "film" es variable temporal con los datos de cada pel√≠cula
          each film in favorites
            
            //- TARJETA INDIVIDUAL DE PEL√çCULA: data-film-id identifica la pel√≠cula para JavaScript
            .film-card(data-film-id=film.id_film || film._id)
              
              //- CONTENEDOR DEL POSTER/CAR√ÅTULA
              .film-poster
                
                //- VERIFICAR SI LA PEL√çCULA TIENE IMAGEN V√ÅLIDA: Comprueba que existe imagen y no es 'N/A'
                if film.image && film.image !== 'N/A'
                  
                  //- MOSTRAR IMAGEN REAL: si la imagen no carga, muestra un placeholder
                  img(src=film.image, alt=film.title, onerror="this.src='/images/placeholder.jpg'")
                
                else
                  
                  //- PLACEHOLDER CUANDO NO HAY IMAGEN
                  .no-poster
                    p No hay p√≥ster  
                
                //- BOTONES DE ACCI√ìN SOBRE LA PEL√çCULA
                .film-actions
                  
                  //- BOT√ìN PARA ELIMINAR DE FAVORITOS
                  button.remove-favorite-btn(type="button", title="Eliminar de favoritos") üóëÔ∏è
              
              //- INFORMACI√ìN DETALLADA DE LA PEL√çCULA
              .film-info
                
                //- T√çTULO DE LA PEL√çCULA: El "=" significa que muestra el valor directamente
                h3.film-title= film.Title
                
                //- A√ëO DE LA PEL√çCULA (si existe)
                if film.year
                  p.film-year üìÖ A√±o: #{film.Year} 
                
                //- DIRECTOR (si existe)
                if film.director
                  p.film-director üë®‚Äçüíº Director: #{film.Director}
                
                //- G√âNERO (si existe)
                if film.gender
                  p.film-genre üè∑Ô∏è G√©nero: #{film.gender}
                
                //- DURACI√ìN (si existe)
                if film.duration
                  p.film-duration ‚è±Ô∏è Duraci√≥n: #{film.duration}
                
                //- SINOPSIS (si existe)
                if film.sinopsis
                  .film-plot
                    h4 Sinopsis: 
                    p= film.sinopsis  
                
                //- ACTORES/REPARTO (si existe)
                if film.actors
                  .film-actors
                    h4 Reparto:  
                    p= film.actors  
              
              //- VALORACIONES/CR√çTICAS (si existen)
              if film.ratings && film.ratings.length > 0
                .film-ratings
                  h4 Valoraciones: 
                  
                  //- BUCLE: POR CADA VALORACI√ìN EN EL ARRAY
                  each rating in film.ratings
                    .rating-item
                      //- Fuente de la valoraci√≥n (ej: "Sensacine")
                      strong #{rating.ref}: 
                      //- Puntuaci√≥n y comentario
                      span #{rating.value} - #{rating.message}
      
      //- ESTADO CUANDO NO HAY FAVORITOS (array vac√≠o)
      else
        .empty-favorites 
          h2 No tienes pel√≠culas favoritas üíî 
          p ¬°Empieza a agregar pel√≠culas a tus favoritos desde la p√°gina de b√∫squeda!
          //- BOT√ìN PARA IR A EXPLORAR PEL√çCULAS
          a.btn-primary(href="/search") Explorar pel√≠culas üîé
    
    //- USUARIO NO LOGUEADO - MOSTRAR MENSAJE DE ACCESO DENEGADO
    else
      .not-logged-in
        .warning-message 
          h2 Acceso restringido
          p Para ver tus pel√≠culas favoritas necesitas estar registrado e iniciar sesi√≥n
          
          //- BOTONES DE ACCI√ìN PARA AUTENTICACI√ìN
          .auth-actions
            a.btn-primary(href="/signup") Registrarse
            a.btn-secondary(href="/api/login") Iniciar sesi√≥n
        
        //- SECCI√ìN DE BENEFICIOS PARA MOTIVAR REGISTRO
        .benefits
          h3 ¬øPor qu√© registrarte?  
          ul  
            li ‚úÖ Guarda tus pel√≠culas favoritas
            li ‚úÖ Recibe recomendaciones personalizadas


  //- MODAL/POPUP DE CONFIRMACI√ìN (solo para usuarios logueados)
  //- Ventana emergente para confirmar eliminaci√≥n
  if user
    #confirmModal.modal  
      .modal-content  
        h3 ¬øEliminar de favoritos?  
        p ¬øEst√°s seguro de que quieres eliminar esta pel√≠cula de tus favoritos?
        
        //- BOTONES DE ACCI√ìN DEL MODAL
        .modal-actions
          a.btn-link(href="/favorites") Cancelar  
          a.btn-link(href="/api/favorites") Eliminar